<extend name="Public/base"/>
<block name="main">
	<meta charset="utf-8"/>
	<div class="row">
		<div class="col-lg-12">
			<div class="panel panel-default">
				<div class="panel-heading">回收站</div>
				<!-- /.panel-heading -->
				<form action="">
					<input type="hidden" name="p" value="1">
					作者：<input type="text" name="username" value="{:I('get.username')}">
					标题：<input type="text" name="title" value="{:I('get.title')}">
					<input type="submit" value="提交">

				</form>
				<div class="panel-body">
					<div class="dataTable_wrapper">
						<div class="dataTables_wrapper form-inline dt-bootstrap no-footer" id="dataTables-example_wrapper">

							<div class="row">
								<div class="col-sm-12">
									<table aria-describedby="dataTables-example_info" role="grid" class="table table-striped table-bordered table-hover dataTable no-footer" id="dataTables-example">
										<thead>
											<tr role="row">
												<th aria-label="Rendering engine: activate to sort column ascending" style="text-align:center" colspan="1" rowspan="1" aria-controls="dataTables-example" tabindex="0" class="sorting"><input type="checkbox" name="all" id="all">全选</th>
												<th aria-label="Rendering engine: activate to sort column ascending" style="text-align:center" colspan="1" rowspan="1" aria-controls="dataTables-example" tabindex="0" class="sorting">帖子id</th>
												<th aria-sort="descending" aria-label="Browser: activate to sort column ascending" style="text-align:center" colspan="1" rowspan="1" aria-controls="dataTables-example" tabindex="0" class="sorting_desc">标题</th>
												<th aria-label="Platform(s): activate to sort column ascending" style="text-align:center" colspan="1" rowspan="1" aria-controls="dataTables-example" tabindex="0" class="sorting">作者</th>
												<th aria-label="Engine version: activate to sort column ascending" style="text-align:center" colspan="1" rowspan="1" aria-controls="dataTables-example" tabindex="0" class="sorting">发布时间</th>
												<th aria-label="CSS grade: activate to sort column ascending" style="text-align:center" colspan="1" rowspan="1" aria-controls="dataTables-example" tabindex="0" class="sorting">操作</th>
											</tr>
										</thead>
										<tbody>

											<tr role="row" class="gradeA odd">

											</tr>
											<volist name="data" id="vo">
												<tr role="row" class="gradeA odd"  data="{$vo['id']}"  style="text-align:center">
													<td><input type="checkbox" value="{$vo['id']}" class="aa"></td>
													<td class="">{$vo['id']}</td>
													<td class="sorting_1">{$vo['title']}</td>
													<td>{$vo['username']}</td>
													<td>{:date('Y-m-d H:i:s',$vo['ctime'])}</td>
													<td class="center">
														<a href="{:U('Lpost/pdetail',array('id'=>$vo['id']))}" class="btn btn-success btn-xs">查看</a>

													</td>
												</tr>
											</volist>
											<tr role="row">
												<td colspan="6">
													<a href="javascript:;" class="del btn btn-danger btn-xs">删除</a>
													<a href="javascript:;" class="rec btn btn-warning btn-xs">还原</a>
												</td>
											</tr>
											<script>
											$(function(){
												$('#all').click(function(){
													var value = $(this).prop('checked');
													$('.aa').each(function(){
														$(this).prop('checked',value);
													})
												})

												$('.del').click(function(){
													//console.log(1);
													var arr = [];
													$('.aa').each(function(){
														if($(this).prop('checked')){
															arr.push($(this).val());
														}
													})
													//console.log(arr);die;
													var str = arr.join(',');
													$.post('{:U("Lpost/delete")}','id='+str,function(msg){
														//console.log(msg);
														if(msg == 'yes'){
															for (var i in arr) {
																$('tr[data='+arr[i]+']').remove();
															}
														} else {
															alert('删除失败');
														}

													})
												})

												$('.rec').click(function(){
													var arr = [];
													$('.aa').each(function(){
														if($(this).prop('checked')){
															arr.push($(this).val());
														}
													})
													var str = arr.join(',');
													$.post('{:U("Lpost/restore")}','id='+str,function(msg){
														//console.log(msg);
														if(msg == 'yes'){
															for (var i in arr) {
																$('tr[data='+arr[i]+']').remove();
															}
														} else {
															alert('还原失败');
														}

													})
												})

											})
											</script>

										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
					<!-- /.table-responsive -->

				</div>
				<!-- /.panel-body -->
			</div>
			<!-- /.panel -->
		</div>
		<!-- /.col-lg-12 -->
	</div>
</block>